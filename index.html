<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบปรึกษาการวิจัยเชิงปริมาณ - Research Methodology Advisor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        
        body { 
            font-family: 'Inter', sans-serif; 
        }

        .card-3d {
            transition: all 0.3s ease;
            transform-style: preserve-3d;
        }

        .card-3d:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .animated-bg {
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .equal-height {
            min-height: 420px;
            display: flex;
            flex-direction: column;
        }

        .tab-active {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
        }

        .tab-inactive {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
        }

        .tab-inactive:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="animated-bg">
    <div id="app"></div>

    <script>
        // ฐานข้อมูลทฤษฎีครบถ้วน 30+ ทฤษฎี 12 สาขา
        const researchDatabase = {
            theories: {
                // === การตลาดดิจิทัล ===
                'tam': {
                    id: 'tam',
                    name: 'Technology Acceptance Model (TAM)',
                    author: 'Davis (1989)',
                    domain: 'digital_marketing',
                    factors: ['Perceived Usefulness (PU)', 'Perceived Ease of Use (PEOU)', 'Attitude Toward Using', 'Behavioral Intention'],
                    relationships: 'PU + PEOU → Attitude → Behavioral Intention → Actual Use',
                    prediction: 'การรับรู้ประโยชน์และความง่ายในการใช้งานจะส่งผลต่อทัศนคติและความตั้งใจในการใช้เทคโนโลยี',
                    keywords: ['technology', 'acceptance', 'digital', 'adoption', 'system', 'user', 'เทคโนโลยี', 'ยอมรับ', 'ระบบ', 'ดิจิทัล'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'EFA', 'Multiple Regression'],
                    description: 'ทฤษฎีที่อธิบายพฤติกรรมการยอมรับเทคโนโลยีของผู้ใช้ โดยเน้นที่การรับรู้ประโยชน์และความง่ายในการใช้งาน เป็นทฤษฎียอดนิยมในการศึกษาการยอมรับเทคโนโลยีใหม่ๆ',
                    references: ['Davis, F. D. (1989). Perceived usefulness, perceived ease of use, and user acceptance of information technology.']
                },
                'tpb': {
                    id: 'tpb',
                    name: 'Theory of Planned Behavior (TPB)',
                    author: 'Ajzen (1991)',
                    domain: 'digital_marketing',
                    factors: ['Attitude Toward Behavior', 'Subjective Norm', 'Perceived Behavioral Control', 'Behavioral Intention'],
                    relationships: 'Attitude + Subjective Norm + PBC → Behavioral Intention → Behavior',
                    prediction: 'ทัศนคติ บรรทัดฐานทางสังคม และการควบคุมพฤติกรรมที่รับรู้จะส่งผลต่อความตั้งใจและพฤติกรรม',
                    keywords: ['behavior', 'intention', 'attitude', 'norm', 'control', 'พฤติกรรม', 'ความตั้งใจ', 'ทัศนคติ'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'EFA', 'SEM'],
                    description: 'ทฤษฎีที่อธิบายความตั้งใจและพฤติกรรมของบุคคลผ่านทัศนคติต่อพฤติกรรม บรรทัดฐานทางสังคม และการควบคุมพฤติกรรมที่รับรู้',
                    references: ['Ajzen, I. (1991). The theory of planned behavior. Organizational behavior and human decision processes.']
                },
                'utaut': {
                    id: 'utaut',
                    name: 'Unified Theory of Acceptance and Use of Technology (UTAUT)',
                    author: 'Venkatesh et al. (2003)',
                    domain: 'digital_marketing',
                    factors: ['Performance Expectancy', 'Effort Expectancy', 'Social Influence', 'Facilitating Conditions'],
                    relationships: 'PE + EE + SI → Behavioral Intention, FC + BI → Use Behavior',
                    prediction: 'ความคาดหวังด้านประสิทธิภาพ ความพยายาม อิทธิพลสังคม และสภาพแวดล้อมที่สนับสนุนจะส่งผลต่อการใช้เทคโนโลยี',
                    keywords: ['technology', 'acceptance', 'performance', 'effort', 'social', 'facilitating', 'เทคโนโลยี', 'ประสิทธิภาพ'],
                    level: 3,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'EFA', 'CFA', 'SEM'],
                    description: 'ทฤษฎีรวมที่อธิบายการยอมรับและใช้เทคโนโลยี รวมจากทฤษฎีต่างๆ เป็นแบบจำลองเดียวที่ครอบคลุม',
                    references: ['Venkatesh, V., Morris, M. G., Davis, G. B., & Davis, F. D. (2003). User acceptance of information technology.']
                },
                'social_commerce': {
                    id: 'social_commerce',
                    name: 'Social Commerce Theory',
                    author: 'Wang & Zhang (2012)',
                    domain: 'digital_marketing',
                    factors: ['Social Support', 'Social Presence', 'Trust', 'Purchase Intention'],
                    relationships: 'Social Support + Social Presence → Trust → Purchase Intention → Purchase Behavior',
                    prediction: 'การสนับสนุนทางสังคมและการรับรู้การมีอยู่ทางสังคมจะส่งผลต่อความไว้วางใจและความตั้งใจซื้อ',
                    keywords: ['social', 'commerce', 'trust', 'purchase', 'online', 'สังคม', 'การค้า', 'ความไว้วางใจ', 'ซื้อ'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'EFA', 'Multiple Regression'],
                    description: 'ทฤษฎีที่อธิบายพฤติกรรมการซื้อในสื่อสังคมออนไลน์ โดยเน้นที่อิทธิพลของปัจจัยทางสังคม',
                    references: ['Wang, C., & Zhang, P. (2012). The evolution of social commerce.']
                },
                'digital_marketing_adoption': {
                    id: 'digital_marketing_adoption',
                    name: 'Digital Marketing Adoption Theory',
                    author: 'Chaffey & Ellis-Chadwick (2019)',
                    domain: 'digital_marketing',
                    factors: ['Perceived Benefits', 'Organizational Readiness', 'External Pressure', 'Adoption Intention'],
                    relationships: 'Perceived Benefits + Organizational Readiness + External Pressure → Adoption Intention → Adoption',
                    prediction: 'การรับรู้ประโยชน์ ความพร้อมขององค์กร และแรงกดดันภายนอกจะส่งผลต่อการยอมรับการตลาดดิจิทัล',
                    keywords: ['digital', 'marketing', 'adoption', 'organization', 'benefits', 'ดิจิทัล', 'การตลาด', 'องค์กร'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'EFA', 'Multiple Regression'],
                    description: 'ทฤษฎีที่อธิบายการยอมรับและนำเครื่องมือการตลาดดิจิทัลมาใช้ในองค์กร',
                    references: ['Chaffey, D., & Ellis-Chadwick, F. (2019). Digital marketing.']
                },

                // === ทุนทางสังคม ===
                'social_capital': {
                    id: 'social_capital',
                    name: 'Social Capital Theory',
                    author: 'Coleman (1988), Bourdieu (1986)',
                    domain: 'social_capital',
                    factors: ['Structural Capital', 'Relational Capital', 'Cognitive Capital', 'Social Networks'],
                    relationships: 'Structural + Relational + Cognitive → Social Capital → Performance Outcomes',
                    prediction: 'ทุนทางสังคมในรูปแบบต่างๆ จะส่งผลต่อประสิทธิภาพและผลลัพธ์ขององค์กรและบุคคล',
                    keywords: ['social', 'capital', 'network', 'relationship', 'trust', 'สังคม', 'ทุน', 'เครือข่าย', 'ความสัมพันธ์'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'EFA', 'Multiple Regression'],
                    description: 'ทฤษฎีที่อธิบายคุณค่าของความสัมพันธ์ทางสังคมและเครือข่ายที่ส่งผลต่อผลลัพธ์ต่างๆ',
                    references: ['Coleman, J. S. (1988). Social capital in the creation of human capital.']
                },
                'social_network': {
                    id: 'social_network',
                    name: 'Social Network Theory',
                    author: 'Granovetter (1973)',
                    domain: 'social_capital',
                    factors: ['Network Structure', 'Tie Strength', 'Network Density', 'Centrality'],
                    relationships: 'Network Structure + Tie Strength → Information Flow → Outcomes',
                    prediction: 'โครงสร้างเครือข่ายและความแข็งแกร่งของความสัมพันธ์จะส่งผลต่อการไหลของข้อมูลและผลลัพธ์',
                    keywords: ['network', 'ties', 'structure', 'centrality', 'information', 'เครือข่าย', 'โครงสร้าง', 'ข้อมูล'],
                    level: 3,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'EFA', 'CFA', 'SEM'],
                    description: 'ทฤษฎีที่อธิบายผลกระทบของโครงสร้างเครือข่ายทางสังคมต่อพฤติกรรมและผลลัพธ์',
                    references: ['Granovetter, M. S. (1973). The strength of weak ties.']
                },

                // === การบริหาร ===
                'rbv': {
                    id: 'rbv',
                    name: 'Resource-Based View (RBV)',
                    author: 'Barney (1991)',
                    domain: 'management',
                    factors: ['Valuable Resources', 'Rare Resources', 'Inimitable Resources', 'Organized Resources'],
                    relationships: 'VRIO Resources → Competitive Advantage → Superior Performance',
                    prediction: 'ทรัพยากรที่มีคุณค่า หายาก เลียนแบบยาก และจัดการได้ดีจะสร้างความได้เปรียบทางการแข่งขัน',
                    keywords: ['resource', 'competitive', 'advantage', 'valuable', 'rare', 'ทรัพยากร', 'การแข่งขัน', 'ความได้เปรียบ'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'EFA', 'Multiple Regression'],
                    description: 'ทฤษฎีที่เน้นความสำคัญของทรัพยากรภายในองค์กรในการสร้างความได้เปรียบทางการแข่งขัน',
                    references: ['Barney, J. (1991). Firm resources and sustained competitive advantage.']
                },
                'dynamic_capabilities': {
                    id: 'dynamic_capabilities',
                    name: 'Dynamic Capabilities Theory',
                    author: 'Teece et al. (1997)',
                    domain: 'management',
                    factors: ['Sensing Capabilities', 'Seizing Capabilities', 'Reconfiguring Capabilities', 'Learning Orientation'],
                    relationships: 'Sensing + Seizing + Reconfiguring → Dynamic Capabilities → Competitive Advantage',
                    prediction: 'ความสามารถในการรับรู้ ยึดครอง และปรับเปลี่ยนจะช่วยองค์กรปรับตัวและสร้างความได้เปรียบ',
                    keywords: ['dynamic', 'capabilities', 'adaptation', 'change', 'learning', 'ความสามารถ', 'การปรับตัว'],
                    level: 3,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'EFA', 'CFA', 'SEM'],
                    description: 'ทฤษฎีที่อธิบายความสามารถขององค์กรในการปรับตัวและพัฒนาในสภาวะแวดล้อมที่เปลี่ยนแปลง',
                    references: ['Teece, D. J., Pisano, G., & Shuen, A. (1997). Dynamic capabilities and strategic management.']
                },
                'institutional_theory': {
                    id: 'institutional_theory',
                    name: 'Institutional Theory',
                    author: 'DiMaggio & Powell (1983)',
                    domain: 'management',
                    factors: ['Coercive Pressure', 'Mimetic Pressure', 'Normative Pressure', 'Institutional Compliance'],
                    relationships: 'Coercive + Mimetic + Normative → Institutional Pressure → Organizational Behavior',
                    prediction: 'แรงกดดันจากสถาบันในรูปแบบต่างๆ จะส่งผลต่อพฤติกรรมและการตัดสินใจขององค์กร',
                    keywords: ['institutional', 'pressure', 'compliance', 'organization', 'legitimacy', 'สถาบัน', 'องค์กร'],
                    level: 3,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'EFA', 'CFA', 'SEM'],
                    description: 'ทฤษฎีที่อธิบายอิทธิพลของสถาบันและสภาพแวดล้อมต่อโครงสร้างและพฤติกรรมองค์กร',
                    references: ['DiMaggio, P. J., & Powell, W. W. (1983). The iron cage revisited.']
                },
                'agency_theory': {
                    id: 'agency_theory',
                    name: 'Agency Theory',
                    author: 'Jensen & Meckling (1976)',
                    domain: 'management',
                    factors: ['Principal-Agent Relationship', 'Information Asymmetry', 'Moral Hazard', 'Monitoring Costs'],
                    relationships: 'Information Asymmetry + Moral Hazard → Agency Problems → Monitoring Costs',
                    prediction: 'ความไม่สมมาตรของข้อมูลและปัญหาทางจริยธรรมจะสร้างต้นทุนในการควบคุมและกำกับดูแล',
                    keywords: ['agency', 'principal', 'agent', 'asymmetry', 'monitoring', 'ตัวแทน', 'ควบคุม'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'EFA', 'Multiple Regression'],
                    description: 'ทฤษฎีที่อธิบายความสัมพันธ์ระหว่างเจ้าของและผู้จัดการ รวมถึงปัญหาที่เกิดขึ้น',
                    references: ['Jensen, M. C., & Meckling, W. H. (1976). Theory of the firm.']
                },

                // === โซ่อุปทาน ===
                'scm_performance': {
                    id: 'scm_performance',
                    name: 'Supply Chain Management Performance Theory',
                    author: 'Christopher (2016)',
                    domain: 'supply_chain',
                    factors: ['Integration', 'Collaboration', 'Information Sharing', 'Performance'],
                    relationships: 'Integration + Collaboration + Information Sharing → SCM Performance',
                    prediction: 'การบูรณาการ การร่วมมือ และการแบ่งปันข้อมูลจะส่งผลต่อประสิทธิภาพการจัดการโซ่อุปทาน',
                    keywords: ['supply', 'chain', 'integration', 'collaboration', 'performance', 'โซ่อุปทาน', 'บูรณาการ'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'EFA', 'Multiple Regression'],
                    description: 'ทฤษฎีที่อธิบายปัจจัยที่ส่งผลต่อประสิทธิภาพการจัดการโซ่อุปทาน',
                    references: ['Christopher, M. (2016). Logistics & supply chain management.']
                },

                // === การเงิน ===
                'modern_portfolio': {
                    id: 'modern_portfolio',
                    name: 'Modern Portfolio Theory (MPT)',
                    author: 'Markowitz (1952)',
                    domain: 'finance',
                    factors: ['Expected Return', 'Risk (Variance)', 'Correlation', 'Efficient Frontier'],
                    relationships: 'Expected Return + Risk + Correlation → Optimal Portfolio → Maximum Utility',
                    prediction: 'การกระจายการลงทุนอย่างเหมาะสมจะช่วยลดความเสี่ยงและเพิ่มผลตอบแทนที่คาดหวัง',
                    keywords: ['portfolio', 'risk', 'return', 'diversification', 'efficient', 'ผลตอบแทน', 'ความเสี่ยง'],
                    level: 3,
                    statistics: ['Descriptive Statistics', 'Correlation Analysis', 'Multiple Regression', 'Optimization'],
                    description: 'ทฤษฎีการจัดพอร์ตการลงทุนที่เน้นการสร้างสมดุลระหว่างความเสี่ยงและผลตอบแทน',
                    references: ['Markowitz, H. (1952). Portfolio selection.']
                },
                'capm': {
                    id: 'capm',
                    name: 'Capital Asset Pricing Model (CAPM)',
                    author: 'Sharpe (1964), Lintner (1965)',
                    domain: 'finance',
                    factors: ['Risk-free Rate', 'Market Risk Premium', 'Beta', 'Expected Return'],
                    relationships: 'Risk-free Rate + Beta × Market Risk Premium → Expected Return',
                    prediction: 'ผลตอบแทนที่คาดหวังจะขึ้นอยู่กับอัตราปลอดความเสี่ยงและความเสี่ยงเทียบกับตลาด',
                    keywords: ['capm', 'beta', 'risk', 'return', 'market', 'pricing', 'ราคา', 'สินทรัพย์'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Correlation Analysis', 'Regression Analysis'],
                    description: 'แบบจำลองการกำหนดราคาสินทรัพย์ทุนที่อธิบายความสัมพันธ์ระหว่างความเสี่ยงและผลตอบแทน',
                    references: ['Sharpe, W. F. (1964). Capital asset prices.']
                },
                'pecking_order': {
                    id: 'pecking_order',
                    name: 'Pecking Order Theory',
                    author: 'Myers & Majluf (1984)',
                    domain: 'finance',
                    factors: ['Internal Financing', 'Debt Financing', 'Equity Financing', 'Information Asymmetry'],
                    relationships: 'Information Asymmetry → Financing Preference → Capital Structure',
                    prediction: 'บริษัทจะเลือกใช้แหล่งเงินทุนตามลำดับ: เงินทุนภายใน หนี้ และหุ้นสามัญ',
                    keywords: ['financing', 'capital', 'structure', 'debt', 'equity', 'การเงิน', 'โครงสร้างเงินทุน'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Correlation Analysis', 'Panel Regression'],
                    description: 'ทฤษฎีที่อธิบายการเลือกใช้แหล่งเงินทุนของบริษัทตามลำดับความชอบ',
                    references: ['Myers, S. C., & Majluf, N. S. (1984). Corporate financing and investment decisions.']
                },

                // === ทรัพยากรมนุษย์ ===
                'expectancy_theory': {
                    id: 'expectancy_theory',
                    name: 'Expectancy Theory',
                    author: 'Vroom (1964)',
                    domain: 'hr',
                    factors: ['Expectancy', 'Instrumentality', 'Valence', 'Motivation'],
                    relationships: 'Expectancy × Instrumentality × Valence → Motivation → Performance',
                    prediction: 'แรงจูงใจจะขึ้นอยู่กับความคาดหวัง ความเชื่อมโยง และคุณค่าของผลลัพธ์',
                    keywords: ['expectancy', 'motivation', 'performance', 'valence', 'instrumentality', 'แรงจูงใจ', 'ประสิทธิภาพ'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'Multiple Regression'],
                    description: 'ทฤษฎีแรงจูงใจที่อธิบายการตัดสินใจของบุคคลในการทำงาน',
                    references: ['Vroom, V. H. (1964). Work and motivation.']
                },
                'job_characteristics': {
                    id: 'job_characteristics',
                    name: 'Job Characteristics Model',
                    author: 'Hackman & Oldham (1976)',
                    domain: 'hr',
                    factors: ['Skill Variety', 'Task Identity', 'Task Significance', 'Autonomy', 'Feedback'],
                    relationships: 'Core Job Characteristics → Psychological States → Work Outcomes',
                    prediction: 'ลักษณะงานหลักจะส่งผลต่อสภาพจิตใจและผลลัพธ์การทำงาน',
                    keywords: ['job', 'characteristics', 'autonomy', 'feedback', 'satisfaction', 'งาน', 'ความพึงพอใจ'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'EFA', 'Multiple Regression'],
                    description: 'แบบจำลองที่อธิบายผลกระทบของลักษณะงานต่อแรงจูงใจและความพึงพอใจ',
                    references: ['Hackman, J. R., & Oldham, G. R. (1976). Motivation through the design of work.']
                },
                'social_exchange': {
                    id: 'social_exchange',
                    name: 'Social Exchange Theory',
                    author: 'Homans (1958), Blau (1964)',
                    domain: 'hr',
                    factors: ['Costs', 'Benefits', 'Reciprocity', 'Trust'],
                    relationships: 'Benefits - Costs → Exchange Satisfaction → Relationship Continuation',
                    prediction: 'ความสัมพันธ์จะดำเนินต่อไปเมื่อผลประโยชน์ที่ได้รับมากกว่าต้นทุนที่เสียไป',
                    keywords: ['exchange', 'reciprocity', 'trust', 'benefits', 'costs', 'การแลกเปลี่ยน', 'ความไว้วางใจ'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Reliability Analysis', 'SEM'],
                    description: 'ทฤษฎีที่อธิบายความสัมพันธ์ทางสังคมในรูปแบบการแลกเปลี่ยนผลประโยชน์',
                    references: ['Homans, G. C. (1958). Social behavior as exchange.']
                },

                // === การค้าระหว่างประเทศ ===
                'gravity_model': {
                    id: 'gravity_model',
                    name: 'Gravity Model of Trade',
                    author: 'Tinbergen (1962)',
                    domain: 'international_trade',
                    factors: ['Economic Size', 'Geographic Distance', 'Cultural Distance', 'Trade Barriers'],
                    relationships: 'Economic Size ÷ (Distance × Trade Barriers) → Trade Volume',
                    prediction: 'ปริมาณการค้าจะเพิ่มขึ้นตามขนาดเศรษฐกิจและลดลงตามระยะทางและอุปสรรคการค้า',
                    keywords: ['trade', 'gravity', 'distance', 'economic', 'barriers', 'การค้า', 'ระยะทาง', 'เศรษฐกิจ'],
                    level: 2,
                    statistics: ['Descriptive Statistics', 'Log-linear Regression', 'Panel Data Analysis'],
                    description: 'แบบจำลองที่อธิบายปริมาณการค้าระหว่างประเทศตามขนาดเศรษฐกิจและระยะทาง',
                   references: ['Tinbergen, J. (1962). Shaping the world economy.']
               },

               // === กลยุทธ์ ===
               'porter_five_forces': {
                   id: 'porter_five_forces',
                   name: 'Porter\'s Five Forces Model',
                   author: 'Porter (1980)',
                   domain: 'strategy',
                   factors: ['Threat of New Entrants', 'Bargaining Power of Suppliers', 'Bargaining Power of Buyers', 'Threat of Substitutes', 'Competitive Rivalry'],
                   relationships: 'Five Forces → Industry Attractiveness → Profitability Potential',
                   prediction: 'ความเข้มข้นของกองกำลัง 5 อย่างจะกำหนดความน่าสนใจและผลกำไรของอุตสาหกรรม',
                   keywords: ['porter', 'five', 'forces', 'competitive', 'strategy', 'กลยุทธ์', 'การแข่งขัน', 'อุตสาหกรรม'],
                   level: 2,
                   statistics: ['Descriptive Statistics', 'Factor Analysis', 'Regression Analysis'],
                   description: 'แบบจำลองการวิเคราะห์โครงสร้างอุตสาหกรรมและความสามารถในการทำกำไร',
                   references: ['Porter, M. E. (1980). Competitive strategy.']
               },

               // === ความยั่งยืน ===
               'stakeholder_theory': {
                   id: 'stakeholder_theory',
                   name: 'Stakeholder Theory',
                   author: 'Freeman (1984)',
                   domain: 'sustainability',
                   factors: ['Stakeholder Identification', 'Stakeholder Engagement', 'Stakeholder Satisfaction', 'Organizational Performance'],
                   relationships: 'Stakeholder Engagement → Stakeholder Satisfaction → Organizational Performance',
                   prediction: 'การดูแลและตอบสนองผู้มีส่วนได้ส่วนเสียจะส่งผลต่อประสิทธิภาพองค์กร',
                   keywords: ['stakeholder', 'engagement', 'sustainability', 'performance', 'ผู้มีส่วนได้เสีย', 'ความยั่งยืน'],
                   level: 2,
                   statistics: ['Descriptive Statistics', 'Reliability Analysis', 'SEM'],
                   description: 'ทฤษฎีที่เน้นความสำคัญของการจัดการความสัมพันธ์กับผู้มีส่วนได้ส่วนเสีย',
                   references: ['Freeman, R. E. (1984). Strategic management: A stakeholder approach.']
               },

               // === บริหารความเสี่ยง ===
               'risk_management_theory': {
                   id: 'risk_management_theory',
                   name: 'Enterprise Risk Management Theory',
                   author: 'COSO (2004)',
                   domain: 'risk_management',
                   factors: ['Risk Identification', 'Risk Assessment', 'Risk Response', 'Risk Monitoring'],
                   relationships: 'Risk ID → Risk Assessment → Risk Response → Risk Monitoring → Performance',
                   prediction: 'การบริหารความเสี่ยงอย่างเป็นระบบจะช่วยลดความไม่แน่นอนและเพิ่มประสิทธิภาพ',
                   keywords: ['risk', 'management', 'assessment', 'monitoring', 'performance', 'ความเสี่ยง', 'การบริหาร'],
                   level: 2,
                   statistics: ['Descriptive Statistics', 'Risk Analysis', 'Regression Analysis'],
                   description: 'ทฤษฎีการบริหารความเสี่ยงองค์กรแบบบูรณาการ',
                   references: ['COSO. (2004). Enterprise risk management framework.']
               },

               // === บริหารโครงการ ===
               'project_success_theory': {
                   id: 'project_success_theory',
                   name: 'Project Success Theory',
                   author: 'Pinto & Slevin (1988)',
                   domain: 'project_management',
                   factors: ['Project Planning', 'Project Execution', 'Stakeholder Management', 'Resource Management'],
                   relationships: 'Planning + Execution + Stakeholder Mgmt + Resource Mgmt → Project Success',
                   prediction: 'การวางแผน การดำเนินงาน การจัดการผู้มีส่วนได้เสีย และทรัพยากรจะส่งผลต่อความสำเร็จของโครงการ',
                   keywords: ['project', 'success', 'planning', 'execution', 'stakeholder', 'โครงการ', 'ความสำเร็จ'],
                   level: 2,
                   statistics: ['Descriptive Statistics', 'Factor Analysis', 'Multiple Regression'],
                   description: 'ทฤษฎีที่อธิบายปัจจัยที่ส่งผลต่อความสำเร็จของโครงการ',
                   references: ['Pinto, J. K., & Slevin, D. P. (1988). Critical success factors in successful project implementation.']
               },

               // === วิเคราะห์ธุรกิจ ===
               'business_intelligence_theory': {
                   id: 'business_intelligence_theory',
                   name: 'Business Intelligence Success Theory',
                   author: 'DeLone & McLean (2003)',
                   domain: 'business_analytics',
                   factors: ['System Quality', 'Information Quality', 'User Satisfaction', 'System Use', 'Individual Impact', 'Organizational Impact'],
                   relationships: 'System Quality + Info Quality → User Satisfaction + Use → Individual Impact → Organizational Impact',
                   prediction: 'คุณภาพระบบและข้อมูลจะส่งผลต่อการใช้งานและผลกระทบต่อบุคคลและองค์กร',
                   keywords: ['business', 'intelligence', 'system', 'quality', 'analytics', 'ธุรกิจ', 'ระบบ', 'คุณภาพ'],
                   level: 3,
                   statistics: ['Descriptive Statistics', 'Reliability Analysis', 'CFA', 'SEM'],
                   description: 'ทฤษฎีความสำเร็จของระบบธุรกิจอัจฉริยะและการวิเคราะห์ข้อมูล',
                   references: ['DeLone, W. H., & McLean, E. R. (2003). The DeLone and McLean model of information systems success.']
               }
           },

           levels: {
               1: {
                   name: 'ระดับพื้นฐาน',
                   steps: '3-5 ขั้นตอน',
                   description: 'เหมาะสำหรับนักศึกษาใหม่หรือการวิจัยเบื้องต้น',
                   methods: ['Descriptive Statistics', 'Reliability Analysis', 'T-test/ANOVA', 'Correlation'],
                   statisticalSteps: [
                       {
                           step: 1,
                           name: 'การเตรียมข้อมูล',
                           description: 'ตรวจสอบและทำความสะอาดข้อมูล',
                           details: ['ตรวจสอบข้อมูลสูญหาย (Missing Data)', 'ตรวจสอบค่าผิดปกติ (Outliers)', 'การรหัสข้อมูล (Data Coding)'],
                           tools: ['Frequencies', 'Descriptives', 'Missing Value Analysis'],
                           duration: '1-2 วัน'
                       },
                       {
                           step: 2,
                           name: 'สถิติเชิงพรรณนา',
                           description: 'อธิบายลักษณะของข้อมูลและกลุ่มตัวอย่าง',
                           details: ['ค่าเฉลี่ย ส่วนเบียงเบนมาตรฐาน', 'ความถี่และร้อยละ', 'การแจกแจงของข้อมูล'],
                           tools: ['Descriptive Statistics', 'Frequencies', 'Charts'],
                           duration: '1 วัน'
                       },
                       {
                           step: 3,
                           name: 'การทดสอบความเชื่อมั่น',
                           description: 'ตรวจสอบความคงที่ของเครื่องมือวัด',
                           details: ['Cronbach\'s Alpha ≥ 0.70', 'Item-Total Correlation ≥ 0.30', 'การปรับปรุงข้อคำถาม'],
                           tools: ['Reliability Analysis', 'Scale Statistics'],
                           duration: '1 วัน'
                       },
                       {
                           step: 4,
                           name: 'การทดสอบสมมติฐาน',
                           description: 'ทดสอบความสัมพันธ์และความแตกต่าง',
                           details: ['T-test สำหรับเปรียบเทียบค่าเฉลี่ย', 'ANOVA สำหรับเปรียบเทียบหลายกลุ่ม', 'Correlation Analysis'],
                           tools: ['Independent T-test', 'One-way ANOVA', 'Pearson Correlation'],
                           duration: '2-3 วัน'
                       }
                   ]
               },
               2: {
                   name: 'ระดับกลาง',
                   steps: '6-8 ขั้นตอน',
                   description: 'เหมาะสำหรับการวิจัยระดับปริญญาโทหรือมีประสบการณ์บ้าง',
                   methods: ['Data Preparation', 'Descriptive', 'Reliability', 'EFA', 'Multiple Regression'],
                   statisticalSteps: [
                       {
                           step: 1,
                           name: 'การเตรียมและตรวจสอบข้อมูล',
                           description: 'ทำความสะอาดและตรวจสอบคุณภาพข้อมูล',
                           details: ['Missing Data Analysis', 'Outlier Detection', 'Normality Testing', 'Linearity Assessment'],
                           tools: ['Missing Value Analysis', 'Explore', 'Regression Diagnostics'],
                           duration: '2-3 วัน'
                       },
                       {
                           step: 2,
                           name: 'สถิติเชิงพรรณนา',
                           description: 'วิเคราะห์ลักษณะข้อมูลเชิงลึก',
                           details: ['Descriptive Statistics', 'Correlation Matrix', 'Cross-tabulation'],
                           tools: ['Descriptives', 'Correlations', 'Crosstabs'],
                           duration: '1-2 วัน'
                       },
                       {
                           step: 3,
                           name: 'การทดสอบความเชื่อมั่น',
                           description: 'ประเมินความน่าเชื่อถือของตัวแปร',
                           details: ['Cronbach\'s Alpha ≥ 0.70', 'Item Analysis', 'Scale Purification'],
                           tools: ['Reliability Analysis', 'Item Statistics'],
                           duration: '1-2 วัน'
                       },
                       {
                           step: 4,
                           name: 'การวิเคราะห์องค์ประกอบเชิงสำรวจ (EFA)',
                           description: 'ค้นหาโครงสร้างแฝงของตัวแปร',
                           details: ['KMO ≥ 0.60', 'Bartlett\'s Test p < 0.05', 'Factor Loading ≥ 0.50', 'Total Variance Explained ≥ 60%'],
                           tools: ['Factor Analysis', 'Principal Component'],
                           duration: '3-4 วัน'
                       },
                       {
                           step: 5,
                           name: 'การวิเคราะห์การถดถอยพหุคูณ',
                           description: 'ทดสอบความสัมพันธ์เชิงสาเหตุ',
                           details: ['Multiple R ≥ 0.30', 'R² และ Adjusted R²', 'VIF < 5 (ไม่มี Multicollinearity)', 'Residual Analysis'],
                           tools: ['Multiple Regression', 'Stepwise Regression'],
                           duration: '3-4 วัน'
                       }
                   ]
               },
               3: {
                   name: 'ระดับสูง',
                   steps: '10-15 ขั้นตอน',
                   description: 'เหมาะสำหรับการวิจัยระดับปริญญาเอกหรือมืออาชีพ',
                   methods: ['Data Screening', 'CMB Testing', 'EFA', 'CFA', 'SEM', 'Mediation/Moderation'],
                   statisticalSteps: [
                       {
                           step: 1,
                           name: 'การคัดกรองและเตรียมข้อมูล',
                           description: 'การตรวจสอบข้อมูลอย่างละเอียด',
                           details: ['Missing Data Pattern Analysis', 'Multivariate Outliers (Mahalanobis Distance)', 'Normality (Skewness & Kurtosis)', 'Linearity & Homoscedasticity'],
                           tools: ['Missing Value Analysis', 'Regression', 'Explore'],
                           duration: '3-4 วัน'
                       },
                       {
                           step: 2,
                           name: 'การทดสอบ Common Method Bias (CMB)',
                           description: 'ตรวจสอบอคติจากวิธีการเก็บข้อมูล',
                           details: ['Harman\'s Single Factor Test', 'Variance Explained < 50%', 'Marker Variable Technique'],
                           tools: ['Factor Analysis', 'SPSS Syntax'],
                           duration: '2-3 วัน'
                       },
                       {
                           step: 3,
                           name: 'การวิเคราะห์องค์ประกอบเชิงสำรวจ (EFA)',
                           description: 'สำรวจโครงสร้างตัวแปรแฝง',
                           details: ['KMO ≥ 0.60', 'Bartlett\'s Test Significant', 'Factor Loading ≥ 0.50', 'Cross-loading < 0.40'],
                           tools: ['Factor Analysis', 'Promax Rotation'],
                           duration: '3-4 วัน'
                       },
                       {
                           step: 4,
                           name: 'การวิเคราะห์องค์ประกอบเชิงยืนยัน (CFA)',
                           description: 'ยืนยันโครงสร้างการวัด',
                           details: ['χ²/df < 3', 'CFI, TLI ≥ 0.95', 'RMSEA ≤ 0.08', 'SRMR ≤ 0.08', 'Factor Loading ≥ 0.70'],
                           tools: ['AMOS', 'LISREL', 'Mplus'],
                           duration: '4-5 วัน'
                       },
                       {
                           step: 5,
                           name: 'การทดสอบความเที่ยงและความตรง',
                           description: 'ประเมินคุณภาพการวัด',
                           details: ['Composite Reliability ≥ 0.70', 'AVE ≥ 0.50', 'Discriminant Validity (Fornell-Larcker)', 'HTMT < 0.85'],
                           tools: ['AMOS', 'Excel Calculation'],
                           duration: '2-3 วัน'
                       },
                       {
                           step: 6,
                           name: 'การวิเคราะห์โมเดลสมการโครงสร้าง (SEM)',
                           description: 'ทดสอบโมเดลทฤษฎีแบบเต็ม',
                           details: ['Model Fit Indices', 'Path Coefficients', 'R² Values', 'Effect Sizes'],
                           tools: ['AMOS', 'LISREL', 'Mplus'],
                           duration: '4-5 วัน'
                       },
                       {
                           step: 7,
                           name: 'การวิเคราะห์ตัวแปรคั่นกลางและกำกับ',
                           description: 'ทดสอบกลไกและเงื่อนไขแห่งผล',
                           details: ['Mediation Analysis (Bootstrap)', 'Moderation Analysis', 'Conditional Effects'],
                           tools: ['PROCESS Macro', 'AMOS', 'Hayes Method'],
                           duration: '3-4 วัน'
                       },
                       {
                           step: 8,
                           name: 'การวิเคราะห์หลายกลุ่ม (Multi-group Analysis)',
                           description: 'เปรียบเทียบโมเดลข้ามกลุ่ม',
                           details: ['Measurement Invariance', 'Structural Invariance', 'Critical Ratio Differences'],
                           tools: ['AMOS Multi-group', 'SPSS Syntax'],
                           duration: '3-4 วัน'
                       }
                   ]
               }
           },

           spssGuides: {
               descriptive: {
                   title: 'สถิติเชิงพรรณนา',
                   icon: '📈',
                   steps: [
                       {
                           step: 'เปิดโปรแกรม SPSS',
                           instruction: 'File → Open → Data... เลือกไฟล์ข้อมูลของคุณ (.sav, .xlsx, .csv)',
                           menu: 'File > Open > Data'
                       },
                       {
                           step: 'เลือกตัวแปรสำหรับวิเคราะห์',
                           instruction: 'Analyze → Descriptive Statistics → Descriptives',
                           menu: 'Analyze > Descriptive Statistics > Descriptives'
                       },
                       {
                           step: 'ตั้งค่าการวิเคราะห์',
                           instruction: 'ย้ายตัวแปรไปยัง Variable(s) box และเลือก Options สำหรับ Mean, Std. Deviation, Minimum, Maximum',
                           menu: 'Options: Mean, Std. Deviation, Min, Max'
                       },
                       {
                           step: 'ดูผลลัพธ์',
                           instruction: 'ตรวจสอบ Output Window สำหรับ Descriptive Statistics Table',
                           menu: 'Output Window'
                       }
                   ],
                   interpretation: [
                       'Mean: ค่าเฉลี่ยของตัวแปร ใช้อธิบายระดับของตัวแปร',
                       'Std. Deviation: ความแปรปรวนของข้อมูล ยิ่งต่ำยิ่งสม่ำเสมอ',
                       'Skewness: การเบ้ ระหว่าง -2 ถึง +2 ถือว่าปกติ',
                       'Kurtosis: การแหลม ระหว่าง -2 ถึง +2 ถือว่าปกติ'
                   ],
                   template: 'จากการวิเคราะห์ข้อมูลเชิงพรรณนา พบว่า ตัวแปร [ชื่อตัวแปร] มีค่าเฉลี่ย X.XX (SD = X.XX) ซึ่งอยู่ในระดับ[สูง/กลาง/ต่ำ] การแจกแจงของข้อมูลมีลักษณะ[ปกติ/เบ้ซ้าย/เบ้ขวา] (Skewness = X.XX, Kurtosis = X.XX)'
               },
               reliability: {
                   title: 'การทดสอบความเชื่อมั่น',
                   icon: '🔒',
                   steps: [
                       {
                           step: 'เข้าสู่เมนู Reliability',
                           instruction: 'Analyze → Scale → Reliability Analysis',
                           menu: 'Analyze > Scale > Reliability Analysis'
                       },
                       {
                           step: 'เลือกตัวแปรในมิติเดียวกัน',
                           instruction: 'ย้ายข้อคำถามที่วัดตัวแปรเดียวกันไปยัง Items box',
                           menu: 'Items Selection'
                       },
                       {
                           step: 'ตั้งค่า Statistics',
                           instruction: 'คลิก Statistics → เลือก Scale if item deleted และ Item-total correlations',
                           menu: 'Statistics > Scale if item deleted'
                       },
                       {
                           step: 'ดูผลลัพธ์ Cronbach\'s Alpha',
                           instruction: 'ตรวจสอบค่า Cronbach\'s Alpha ≥ 0.70 และ Corrected Item-Total Correlation ≥ 0.30',
                           menu: 'Reliability Statistics Table'
                       }
                   ],
                   interpretation: [
                       'Cronbach\'s Alpha ≥ 0.70: ความเชื่อมั่นที่ยอมรับได้',
                       'Cronbach\'s Alpha ≥ 0.80: ความเชื่อมั่นที่ดี',
                       'Cronbach\'s Alpha ≥ 0.90: ความเชื่อมั่นที่ดีมาก',
                       'Corrected Item-Total Correlation ≥ 0.30: ข้อคำถามมีความสัมพันธ์ดีกับมิติ'
                   ],
                   template: 'การทดสอบความเชื่อมั่นของแบบสอบถาม พบว่า ตัวแปร [ชื่อตัวแปร] มีค่า Cronbach\'s Alpha เท่ากับ X.XX ซึ่ง[สูงกว่า/เท่ากับ]เกณฑ์ที่ยอมรับได้ (α ≥ 0.70) แสดงว่าแบบสอบถามมีความเชื่อมั่น[ที่ดี/ที่ยอมรับได้]'
               },
               efa: {
                   title: 'การวิเคราะห์องค์ประกอบเชิงสำรวจ (EFA)',
                   icon: '🔍',
                   steps: [
                       {
                           step: 'เข้าสู่เมนู Factor Analysis',
                           instruction: 'Analyze → Dimension Reduction → Factor',
                           menu: 'Analyze > Dimension Reduction > Factor'
                       },
                       {
                           step: 'เลือกตัวแปรทั้งหมด',
                           instruction: 'ย้ายตัวแปรทั้งหมดที่ต้องการวิเคราะห์ไปยัง Variables box',
                           menu: 'Variables Selection'
                       },
                       {
                           step: 'ตั้งค่า Descriptives',
                           instruction: 'คลิก Descriptives → เลือก KMO and Bartlett\'s test of sphericity',
                           menu: 'Descriptives > KMO and Bartlett test'
                       },
                       {
                           step: 'ตั้งค่า Extraction',
                           instruction: 'คลิก Extraction → เลือก Principal components หรือ Maximum likelihood',
                           menu: 'Extraction > Principal Components'
                       },
                       {
                           step: 'ตั้งค่า Rotation',
                           instruction: 'คลิก Rotation → เลือก Varimax (orthogonal) หรือ Promax (oblique)',
                           menu: 'Rotation > Varimax/Promax'
                       }
                   ],
                   interpretation: [
                       'KMO ≥ 0.60: ข้อมูลเหมาะสมสำหรับ Factor Analysis',
                       'Bartlett\'s Test p < 0.05: ตัวแปรมีความสัมพันธ์กัน',
                       'Factor Loading ≥ 0.50: ข้อคำถามอยู่ในองค์ประกอบนั้น',
                       'Total Variance Explained ≥ 60%: องค์ประกอบอธิบายความแปรปรวนได้ดี'
                   ],
                   template: 'การวิเคราะห์องค์ประกอบเชิงสำรวจ พบว่า ค่า KMO เท่ากับ X.XX (> 0.60) และ Bartlett\'s Test มีนัยสำคัญทางสถิติ (p < 0.05) แสดงว่าข้อมูลเหมาะสมสำหรับการวิเคราะห์องค์ประกอบ จากการวิเคราะห์พบองค์ประกอบ X องค์ประกอบ ที่สามารถอธิบายความแปรปรวนได้ XX.XX%'
               },
               regression: {
                   title: 'การวิเคราะห์การถดถอยพหุคูณ',
                   icon: '📈',
                   steps: [
                       {
                           step: 'เข้าสู่เมนู Regression',
                           instruction: 'Analyze → Regression → Linear',
                           menu: 'Analyze > Regression > Linear'
                       },
                       {
                           step: 'กำหนดตัวแปร',
                           instruction: 'ย้าย Dependent Variable (ตัวแปรตาม) และ Independent Variables (ตัวแปรต้น)',
                           menu: 'Dependent/Independent Variables'
                       },
                       {
                           step: 'ตั้งค่า Statistics',
                           instruction: 'คลิก Statistics → เลือก Estimates, Model fit, Collinearity diagnostics',
                           menu: 'Statistics > Estimates, Model fit'
                       },
                       {
                           step: 'ตั้งค่า Plots',
                           instruction: 'คลิก Plots → เลือก *ZPRED vs *ZRESID สำหรับตรวจสอบ assumptions',
                           menu: 'Plots > ZPRED vs ZRESID'
                       }
                   ],
                   interpretation: [
                       'R Square: สัดส่วนความแปรปรวนที่อธิบายได้ (ยิ่งสูงยิ่งดี)',
                       'F-statistic p < 0.05: โมเดลมีความหมายทางสถิติ',
                       'Beta Coefficients p < 0.05: ตัวแปรมีอิทธิพลอย่างมีนัยสำคัญ',
                       'VIF < 5: ไม่มีปัญหา Multicollinearity'
                   ],
                   template: 'การวิเคราะห์การถดถอยพหุคูณ พบว่า โมเดลมีความหมายทางสถิติ (F = XX.XX, p < 0.05) โดยตัวแปรต้นสามารถอธิบายความแปรปรวนของตัวแปรตามได้ XX.XX% (Adjusted R² = X.XX) ตัวแปร[ชื่อตัวแปร]มีอิทธิพลต่อ[ตัวแปรตาม]อย่างมีนัยสำคัญ (β = X.XX, p < 0.05)'
               },
               cfa: {
                   title: 'การวิเคราะห์องค์ประกอบเชิงยืนยัน (CFA)',
                   icon: '✅',
                   steps: [
                       {

                    step: 'เปิดโปรแกรม AMOS',
                           instruction: 'เปิด AMOS Graphics และสร้าง Path Diagram ใหม่',
                           menu: 'AMOS Graphics > New Path Diagram'
                       },
                       {
                           step: 'วาดโมเดลการวัด',
                           instruction: 'ใช้เครื่องมือ Draw latent variables และ Draw observed variables',
                           menu: 'Draw Tools > Latent/Observed Variables'
                       },
                       {
                           step: 'เชื่อมโยงข้อมูล',
                           instruction: 'File → Data Files → เลือกไฟล์ข้อมูล SPSS (.sav)',
                           menu: 'File > Data Files > Select SPSS file'
                       },
                       {
                           step: 'รันการวิเคราะห์',
                           instruction: 'Analyze → Calculate Estimates หรือกด Ctrl+F9',
                           menu: 'Analyze > Calculate Estimates'
                       },
                       {
                           step: 'ดูผลลัพธ์',
                           instruction: 'View → Text Output หรือ View → Estimates เพื่อดู Fit Indices',
                           menu: 'View > Text Output/Estimates'
                       }
                   ],
                   interpretation: [
                       'χ²/df < 3: ความกลมกลืนของโมเดลดี',
                       'CFI, TLI ≥ 0.95: ความกลมกลืนเปรียบเทียบดี',
                       'RMSEA ≤ 0.08: ความคลาดเคลื่อนต่ำ',
                       'SRMR ≤ 0.08: ความคลาดเคลื่อนของ residual ต่ำ',
                       'Factor Loading ≥ 0.70: ตัวบ่งชี้วัดตัวแปรแฝงได้ดี'
                   ],
                   template: 'การวิเคราะห์องค์ประกอบเชิงยืนยัน พบว่า โมเดลมีความกลมกลืนกับข้อมูลเชิงประจักษ์ χ²/df = X.XX, CFI = X.XX, TLI = X.XX, RMSEA = X.XX, SRMR = X.XX ซึ่งเป็นไปตามเกณฑ์ที่ยอมรับได้ แสดงว่าโมเดลการวัดมีความตรงเชิงโครงสร้าง'
               },
               sem: {
                   title: 'การวิเคราะห์โมเดลสมการโครงสร้าง (SEM)',
                   icon: '🏗️',
                   steps: [
                       {
                           step: 'สร้าง Full Structural Model',
                           instruction: 'ใน AMOS วาดโมเดลเต็มที่รวม Measurement Model + Structural Model',
                           menu: 'AMOS > Draw Full Model'
                       },
                       {
                           step: 'กำหนด Path Coefficients',
                           instruction: 'วาดเส้นเชื่อมจากตัวแปรต้นไปตัวแปรตาม ตามทฤษฎี',
                           menu: 'Draw Paths > Structural Paths'
                       },
                       {
                           step: 'ตั้งค่า Model Identification',
                           instruction: 'กำหนดค่าคงที่ (Fix) Factor Loading = 1 สำหรับตัวบ่งชี้อ้างอิง',
                           menu: 'Object Properties > Fix Parameter'
                       },
                       {
                           step: 'รันและตรวจสอบ Model Fit',
                           instruction: 'Calculate Estimates และตรวจสอบ Fit Indices ทั้งหมด',
                           menu: 'Analyze > Calculate Estimates'
                       },
                       {
                           step: 'ตีความ Path Coefficients',
                           instruction: 'ดู Standardized Estimates สำหรับความแข็งแกร่งของความสัมพันธ์',
                           menu: 'View > Standardized Estimates'
                       }
                   ],
                   interpretation: [
                       'Model Fit เหมือน CFA: χ²/df < 3, CFI ≥ 0.95, RMSEA ≤ 0.08',
                       'Path Coefficients p < 0.05: ความสัมพันธ์มีนัยสำคัญ',
                       'R² ≥ 0.25: ตัวแปรตามถูกอธิบายได้ดีพอสมควร',
                       'Effect Size: Small (0.10), Medium (0.30), Large (0.50)'
                   ],
                   template: 'การวิเคราะห์โมเดลสมการโครงสร้าง พบว่า โมเดลมีความกลมกลืนกับข้อมูลเชิงประจักษ์ในระดับที่ยอมรับได้ (χ²/df = X.XX, CFI = X.XX, RMSEA = X.XX) ผลการวิเคราะห์แสดงว่า [ตัวแปรต้น] มีอิทธิพลเชิงบวกต่อ [ตัวแปรตาม] อย่างมีนัยสำคัญทางสถิติ (β = X.XX, p < 0.05)'
               }
           }
       };

       // State
       let currentState = {
           page: 'landing',
           topic: '',
           level: null,
           theory: null,
           activeTab: 'theory',
           activeSPSSGuide: 'descriptive'
           selectedDomain: null  // เพิ่มบรรทัดนี้       };
// เพิ่มฟังก์ชันใหม่
function selectDomain(domain) {
    currentState.selectedDomain = domain;
    
    // Update UI
    document.querySelectorAll('.domain-btn').forEach(btn => {
        btn.classList.remove('bg-white/30', 'border-yellow-400');
        btn.classList.add('bg-white/10', 'border-white/30');
    });
    
    event.target.closest('.domain-btn').classList.remove('bg-white/10', 'border-white/30');
    event.target.closest('.domain-btn').classList.add('bg-white/30', 'border-yellow-400');
    
    // Show selected domain
    const domainNames = {
        'digital_marketing': 'การตลาดดิจิทัล',
        'social_capital': 'ทุนทางสังคม',
        'management': 'การบริหาร',
        'finance': 'การเงิน',
        'hr': 'ทรัพยากรมนุษย์',
        'supply_chain': 'โซ่อุปทาน',
        'international_trade': 'การค้าระหว่างประเทศ',
        'strategy': 'กลยุทธ์',
        'sustainability': 'ความยั่งยืน',
        'risk_management': 'บริหารความเสี่ยง',
        'project_management': 'บริหารโครงการ',
        'business_analytics': 'วิเคราะห์ธุรกิจ'
    };
    
    document.getElementById('selected-domain').classList.remove('hidden');
    document.getElementById('domain-name').textContent = domainNames[domain];
}

function clearDomain() {
    currentState.selectedDomain = null;
    document.getElementById('selected-domain').classList.add('hidden');
    
    document.querySelectorAll('.domain-btn').forEach(btn => {
        btn.classList.remove('bg-white/30', 'border-yellow-400');
        btn.classList.add('bg-white/10', 'border-white/30');
    });
}

function setExample(text, domain = null) {
    document.getElementById('researchTopic').value = text;
    if (domain) {
        selectDomain(domain);
    }
    }     // ปรับฟังก์ชันค้นหาทฤษฎี
function findRelevantTheories(topic) {
    const topicLower = topic.toLowerCase();
    const relevantTheories = [];

    Object.values(researchDatabase.theories).forEach(theory => {
        let score = 0;
        
        // ถ้าผู้ใช้เลือกสาขา ให้คะแนนพิเศษ
        if (currentState.selectedDomain && theory.domain === currentState.selectedDomain) {
            score += 5; // คะแนนพิเศษสูง
        }
        
        // ตรวจสอบ keywords
        theory.keywords.forEach(keyword => {
            if (topicLower.includes(keyword.toLowerCase())) {
                score += 2;
            }
        });

        // ตรวจสอบชื่อทฤษฎี
        if (topicLower.includes(theory.name.toLowerCase())) {
            score += 3;
        }

        // Domain-based scoring (เหมือนเดิม...)
        if (topicLower.includes('เทคโนโลยี') || topicLower.includes('ดิจิทัล') || topicLower.includes('ออนไลน์') || topicLower.includes('ระบบ')) {
            if (theory.domain === 'digital_marketing') score += 3;
        }
        
        if (topicLower.includes('สังคม') || topicLower.includes('เครือข่าย') || topicLower.includes('ความสัมพันธ์') || topicLower.includes('ชุมชน')) {
            if (theory.domain === 'social_capital') score += 3;
        }

        if (topicLower.includes('บริหาร') || topicLower.includes('องค์กร') || topicLower.includes('จัดการ') || topicLower.includes('ผู้บริหาร')) {
            if (theory.domain === 'management') score += 3;
        }

        if (topicLower.includes('การเงิน') || topicLower.includes('ลงทุน') || topicLower.includes('หุ้น') || topicLower.includes('พอร์ต')) {
            if (theory.domain === 'finance') score += 3;
        }

        if (topicLower.includes('พนักงาน') || topicLower.includes('แรงจูงใจ') || topicLower.includes('ความพึงพอใจ') || topicLower.includes('ทรัพยากรมนุษย์')) {
            if (theory.domain === 'hr') score += 3;
        }

        if (topicLower.includes('โซ่อุปทาน') || topicLower.includes('ซัพพลาย') || topicLower.includes('โลจิสติกส์') || topicLower.includes('การจัดส่ง')) {
            if (theory.domain === 'supply_chain') score += 3;
        }

        if (topicLower.includes('โครงการ') || topicLower.includes('project')) {
            if (theory.domain === 'project_management') score += 3;
        }

        if (score > 0) {
            relevantTheories.push({ ...theory, score });
        }
    });

    // ถ้าไม่มีทฤษฎีที่ตรงกัน ให้แสดงทฤษฎียอดนิยม
    if (relevantTheories.length === 0) {
        return [
            researchDatabase.theories.tam,
            researchDatabase.theories.tpb,
            researchDatabase.theories.social_capital
        ].map(theory => ({ ...theory, score: 1 }));
    }

    // เรียงลำดับตาม score
    return relevantTheories
        .sort((a, b) => b.score - a.score)
        .slice(0, 3);
}

       // Landing Page
       // Landing Page
function renderLanding() {
    return `
        <div class="min-h-screen relative overflow-hidden fade-in">
            <div class="container mx-auto px-4 py-16 relative z-10">
                <div class="text-center mb-16">
                    <div class="text-8xl mb-6">🎓</div>
                    <h1 class="text-6xl font-extrabold text-white mb-6 drop-shadow-lg">
                        <span class="bg-gradient-to-r from-yellow-300 to-orange-300 bg-clip-text text-transparent">
                            ระบบปรึกษาการวิจัย
                        </span>
                        <br>
                        <span class="text-4xl font-bold text-white">เชิงปริมาณ</span>
                    </h1>
                    <p class="text-2xl text-white/90 font-medium drop-shadow-md">
                        Research Methodology Advisor - AI Powered
                    </p>
                    <p class="text-lg text-white/80 mt-2">
                        เครื่องมือช่วยวางแผนการวิจัยแบบครบวงจร 25+ ทฤษฎี 12 สาขาวิชา
                    </p>
                </div>

                <div class="max-w-6xl mx-auto">
                    <div class="glass rounded-3xl shadow-2xl p-10 card-3d">
                        <h2 class="text-3xl font-bold text-white mb-8 text-center">
                            🔍 เริ่มต้นการวิเคราะห์โจทย์วิจัยของคุณ
                        </h2>

                        <!-- เลือกสาขาวิชา -->
                        <div class="mb-8">
                            <label class="block text-white font-semibold mb-4 text-lg">
                                🎯 เลือกสาขาวิชาของคุณ (ทางเลือก):
                            </label>
                            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 mb-6">
                                <button onclick="selectDomain('digital_marketing')" 
                                        class="domain-btn bg-white/10 hover:bg-white/20 border border-white/30 rounded-xl p-3 text-center transition-all group">
                                    <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">📱</div>
                                    <div class="text-white font-medium text-sm">การตลาดดิจิทัล</div>
                                </button>
                                <button onclick="selectDomain('social_capital')" 
                                        class="domain-btn bg-white/10 hover:bg-white/20 border border-white/30 rounded-xl p-3 text-center transition-all group">
                                    <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">🤝</div>
                                    <div class="text-white font-medium text-sm">ทุนทางสังคม</div>
                                </button>
                                <button onclick="selectDomain('management')" 
                                        class="domain-btn bg-white/10 hover:bg-white/20 border border-white/30 rounded-xl p-3 text-center transition-all group">
                                    <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">🏢</div>
                                    <div class="text-white font-medium text-sm">การบริหาร</div>
                                </button>
                                <button onclick="selectDomain('finance')" 
                                        class="domain-btn bg-white/10 hover:bg-white/20 border border-white/30 rounded-xl p-3 text-center transition-all group">
                                    <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">💰</div>
                                    <div class="text-white font-medium text-sm">การเงิน</div>
                                </button>
                                <button onclick="selectDomain('hr')" 
                                        class="domain-btn bg-white/10 hover:bg-white/20 border border-white/30 rounded-xl p-3 text-center transition-all group">
                                    <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">👥</div>
                                    <div class="text-white font-medium text-sm">ทรัพยากรมนุษย์</div>
                                </button>
                                <button onclick="selectDomain('supply_chain')" 
                                        class="domain-btn bg-white/10 hover:bg-white/20 border border-white/30 rounded-xl p-3 text-center transition-all group">
                                    <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">🚚</div>
                                    <div class="text-white font-medium text-sm">โซ่อุปทาน</div>
                                </button>
                                <button onclick="selectDomain('international_trade')" 
                                        class="domain-btn bg-white/10 hover:bg-white/20 border border-white/30 rounded-xl p-3 text-center transition-all group">
                                    <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">🌍</div>
                                    <div class="text-white font-medium text-sm">การค้าระหว่างประเทศ</div>
                                </button>
                                <button onclick="selectDomain('strategy')" 
                                        class="domain-btn bg-white/10 hover:bg-white/20 border border-white/30 rounded-xl p-3 text-center transition-all group">
                                    <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">🎯</div>
                                    <div class="text-white font-medium text-sm">กลยุทธ์</div>
                                </button>
                                <button onclick="selectDomain('sustainability')" 
                                        class="domain-btn bg-white/10 hover:bg-white/20 border border-white/30 rounded-xl p-3 text-center transition-all group">
                                    <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">🌱</div>
                                    <div class="text-white font-medium text-sm">ความยั่งยืน</div>
                                </button>
                                <button onclick="selectDomain('risk_management')" 
                                        class="domain-btn bg-white/10 hover:bg-white/20 border border-white/30 rounded-xl p-3 text-center transition-all group">
                                    <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">⚠️</div>
                                    <div class="text-white font-medium text-sm">บริหารความเสี่ยง</div>
                                </button>
                                <button onclick="selectDomain('project_management')" 
                                        class="domain-btn bg-white/10 hover:bg-white/20 border border-white/30 rounded-xl p-3 text-center transition-all group">
                                    <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">📊</div>
                                    <div class="text-white font-medium text-sm">บริหารโครงการ</div>
                                </button>
                                <button onclick="selectDomain('business_analytics')" 
                                        class="domain-btn bg-white/10 hover:bg-white/20 border border-white/30 rounded-xl p-3 text-center transition-all group">
                                    <div class="text-2xl mb-2 group-hover:scale-110 transition-transform">📈</div>
                                    <div class="text-white font-medium text-sm">วิเคราะห์ธุรกิจ</div>
                                </button>
                            </div>
                            <div id="selected-domain" class="hidden">
                                <div class="bg-white/20 rounded-lg p-3 mb-4">
                                    <span class="text-white font-medium">สาขาที่เลือก: </span>
                                    <span id="domain-name" class="text-yellow-200 font-bold"></span>
                                    <button onclick="clearDomain()" class="ml-2 text-red-300 hover:text-red-100">✕</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-8">
                            <label class="block text-white font-semibold mb-4 text-lg">
                                💭 โจทย์วิจัยหรือหัวข้อที่คุณสนใจศึกษา:
                            </label>
                            <textarea
                                id="researchTopic"
                                placeholder="เช่น ศึกษาปัจจัยที่มีผลต่อการยอมรับเทคโนโลยีการเรียนออนไลน์ของนักศึกษา..."
                                class="w-full h-40 p-6 border-0 rounded-2xl focus:outline-none resize-none text-gray-800 text-lg"
                                style="background: rgba(255,255,255,0.9);"
                            ></textarea>
                        </div>

                        <button
                            onclick="analyzeTopic()"
                            class="w-full bg-gradient-to-r from-orange-500 to-pink-500 hover:from-orange-600 hover:to-pink-600 text-white font-bold py-4 px-8 rounded-2xl transition-all text-xl"
                        >
                            ✨ วิเคราะห์โจทย์วิจัยด้วย AI
                        </button>

                        <div class="mt-10">
                            <h3 class="text-xl font-bold text-white mb-6 text-center">
                                🎯 ตัวอย่างโจทย์วิจัยยอดนิยมแต่ละสาขา
                            </h3>
                            <div class="grid gap-4">
                                <button onclick="setExample('ศึกษาปัจจัยที่มีผลต่อการยอมรับเทคโนโลยีการเรียนออนไลน์ของนักศึกษา', 'digital_marketing')" 
                                        class="text-left p-4 glass rounded-xl hover:bg-white/20 transition-all group">
                                    <div class="flex items-center gap-4">
                                        <span class="text-3xl group-hover:scale-110 transition-transform">📱</span>
                                        <div>
                                            <span class="text-white font-medium">ศึกษาปัจจัยที่มีผลต่อการยอมรับเทคโนโลยีการเรียนออนไลน์ของนักศึกษา</span>
                                            <div class="text-yellow-200 text-sm mt-1">การตลาดดิจิทัล</div>
                                        </div>
                                    </div>
                                </button>
                                <button onclick="setExample('วิเคราะห์ความสัมพันธ์ระหว่างทุนทางสังคมกับประสิทธิภาพการทำงานของพนักงาน', 'social_capital')" 
                                        class="text-left p-4 glass rounded-xl hover:bg-white/20 transition-all group">
                                    <div class="flex items-center gap-4">
                                        <span class="text-3xl group-hover:scale-110 transition-transform">🤝</span>
                                        <div>
                                            <span class="text-white font-medium">วิเคราะห์ความสัมพันธ์ระหว่างทุนทางสังคมกับประสิทธิภาพการทำงานของพนักงาน</span>
                                            <div class="text-yellow-200 text-sm mt-1">ทุนทางสังคม</div>
                                        </div>
                                    </div>
                                </button>
                                <button onclick="setExample('ศึกษาผลกระทบของการตลาดดิจิทัลต่อความตั้งใจซื้อของผู้บริโภค', 'digital_marketing')" 
                                        class="text-left p-4 glass rounded-xl hover:bg-white/20 transition-all group">
                                    <div class="flex items-center gap-4">
                                        <span class="text-3xl group-hover:scale-110 transition-transform">🛒</span>
                                        <div>
                                            <span class="text-white font-medium">ศึกษาผลกระทบของการตลาดดิจิทัลต่อความตั้งใจซื้อของผู้บริโภค</span>
                                            <div class="text-yellow-200 text-sm mt-1">การตลาดดิจิทัล</div>
                                        </div>
                                    </div>
                                </button>
                                <button onclick="setExample('วิเคราะห์ปัจจัยความสำเร็จของการบริหารโครงการในองค์กร', 'project_management')" 
                                        class="text-left p-4 glass rounded-xl hover:bg-white/20 transition-all group">
                                    <div class="flex items-center gap-4">
                                        <span class="text-3xl group-hover:scale-110 transition-transform">📊</span>
                                        <div>
                                            <span class="text-white font-medium">วิเคราะห์ปัจจัยความสำเร็จของการบริหารโครงการในองค์กร</span>
                                            <div class="text-yellow-200 text-sm mt-1">บริหารโครงการ</div>
                                        </div>
                                    </div>
                                </button>
                                <button onclick="setExample('ศึกษาแรงจูงใจและความพึงพอใจในการทำงานของพนักงาน', 'hr')" 
                                        class="text-left p-4 glass rounded-xl hover:bg-white/20 transition-all group">
                                    <div class="flex items-center gap-4">
                                        <span class="text-3xl group-hover:scale-110 transition-transform">👥</span>
                                        <div>
                                            <span class="text-white font-medium">ศึกษาแรงจูงใจและความพึงพอใจในการทำงานของพนักงาน</span>
                                            <div class="text-yellow-200 text-sm mt-1">ทรัพยากรมนุษย์</div>
                                        </div>
                                    </div>
                                </button>
                                <button onclick="setExample('วิเคราะห์ความได้เปรียบทางการแข่งขันของทรัพยากรองค์กร', 'management')" 
                                        class="text-left p-4 glass rounded-xl hover:bg-white/20 transition-all group">
                                    <div class="flex items-center gap-4">
                                        <span class="text-3xl group-hover:scale-110 transition-transform">🏢</span>
                                        <div>
                                            <span class="text-white font-medium">วิเคราะห์ความได้เปรียบทางการแข่งขันของทรัพยากรองค์กร</span>
                                            <div class="text-yellow-200 text-sm mt-1">การบริหาร</div>
                                        </div>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}

       // Level Selection
       function renderLevelSelection() {
           return `
               <div class="min-h-screen relative overflow-hidden fade-in">
                   <div class="container mx-auto px-4 py-12 relative z-10">
                       <div class="text-center mb-12">
                           <h1 class="text-5xl font-extrabold text-white mb-6 drop-shadow-lg">
                               🎯 เลือกระดับความซับซ้อน
                           </h1>
                           <div class="glass rounded-2xl p-6 max-w-4xl mx-auto">
                               <p class="text-white/90 mb-3 text-lg">📝 โจทย์วิจัยของคุณ:</p>
                               <p class="text-white font-bold text-xl">${currentState.topic}</p>
                           </div>
                       </div>

                       <div class="max-w-7xl mx-auto">
                           <div class="grid md:grid-cols-3 gap-8">
                               <!-- Level 1 -->
                               <div class="equal-height bg-gradient-to-br from-green-400 to-blue-500 rounded-3xl p-8 card-3d">
                                   <div class="flex flex-col h-full">
                                       <div class="text-center mb-6">
                                           <div class="text-6xl mb-4">📊</div>
                                           <h3 class="text-3xl font-bold text-white mb-2">ระดับพื้นฐาน</h3>
                                           <div class="bg-white/30 rounded-full px-4 py-2 inline-block">
                                               <span class="font-bold text-white">BEGINNER</span>
                                           </div>
                                       </div>
                                       
                                       <div class="space-y-4 mb-8 flex-grow">
                                           <div class="bg-white/20 rounded-xl p-4">
                                               <span class="text-white font-semibold">⏱️ ขั้นตอน: 3-5 ขั้นตอน</span>
                                           </div>
                                           <div class="bg-white/20 rounded-xl p-4">
                                               <span class="text-white font-semibold">📅 ระยะเวลา: 2-3 เดือน</span>
                                           </div>
                                           <div class="bg-white/20 rounded-xl p-4">
                                               <span class="text-white font-semibold">🎓 เหมาะสำหรับ: นักศึกษาปริญญาตรี</span>
                                           </div>
                                           <div class="bg-white/20 rounded-xl p-4">
                                               <span class="text-white font-semibold">📊 วิธีการ: สถิติเบื้องต้น</span>
                                           </div>
                                       </div>
                                       
                                       <button onclick="selectLevel(1)" 
                                               class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-2xl transition-all text-lg mt-auto">
                                           ✅ เลือกระดับนี้
                                       </button>
                                   </div>
                               </div>

                               <!-- Level 2 -->
                               <div class="equal-height bg-gradient-to-br from-blue-400 to-purple-500 rounded-3xl p-8 card-3d">
                                   <div class="flex flex-col h-full">
                                       <div class="text-center mb-6">
                                           <div class="text-6xl mb-4">📈</div>
                                           <h3 class="text-3xl font-bold text-white mb-2">ระดับกลาง</h3>
                                           <div class="bg-white/30 rounded-full px-4 py-2 inline-block">
                                               <span class="font-bold text-white">INTERMEDIATE</span>
                                           </div>
                                       </div>
                                       
                                       <div class="space-y-4 mb-8 flex-grow">
                                           <div class="bg-white/20 rounded-xl p-4">
                                               <span class="text-white font-semibold">⏱️ ขั้นตอน: 6-8 ขั้นตอน</span>
                                           </div>
                                           <div class="bg-white/20 rounded-xl p-4">
                                               <span class="text-white font-semibold">📅 ระยะเวลา: 4-6 เดือน</span>
                                           </div>
                                           <div class="bg-white/20 rounded-xl p-4">
                                               <span class="text-white font-semibold">🎓 เหมาะสำหรับ: นักศึกษาปริญญาโท</span>
                                           </div>
                                           <div class="bg-white/20 rounded-xl p-4">
                                               <span class="text-white font-semibold">📊 วิธีการ: EFA + Regression</span>
                                           </div>
                                       </div>
                                       
                                       <button onclick="selectLevel(2)" 
                                               class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-6 rounded-2xl transition-all text-lg mt-auto">
                                           ✅ เลือกระดับนี้
                                       </button>
                                   </div>
                               </div>

                               <!-- Level 3 -->
                               <div class="equal-height bg-gradient-to-br from-purple-400 to-pink-500 rounded-3xl p-8 card-3d">
                                   <div class="flex flex-col h-full">
                                       <div class="text-center mb-6">
                                           <div class="text-6xl mb-4">🎯</div>
                                           <h3 class="text-3xl font-bold text-white mb-2">ระดับสูง</h3>
                                           <div class="bg-white/30 rounded-full px-4 py-2 inline-block">
                                               <span class="font-bold text-white">ADVANCED</span>
                                           </div>
                                       </div>
                                       
                                       <div class="space-y-4 mb-8 flex-grow">
                                           <div class="bg-white/20 rounded-xl p-4">
                                               <span class="text-white font-semibold">⏱️ ขั้นตอน: 10-15 ขั้นตอน</span>
                                           </div>
                                           <div class="bg-white/20 rounded-xl p-4">
                                               <span class="text-white font-semibold">📅 ระยะเวลา: 8-12 เดือน</span>
                                           </div>
                                           <div class="bg-white/20 rounded-xl p-4">
                                               <span class="text-white font-semibold">🎓 เหมาะสำหรับ: นักศึกษาปริญญาเอก</span>
                                           </div>
                                           <div class="bg-white/20 rounded-xl p-4">
                                               <span class="text-white font-semibold">📊 วิธีการ: CFA + SEM</span>
                                           </div>
                                       </div>
                                       
                                       <button onclick="selectLevel(3)" 
                                               class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-4 px-6 rounded-2xl transition-all text-lg mt-auto">
                                           ✅ เลือกระดับนี้
                                       </button>
                                   </div>
                               </div>
                           </div>
                       </div>

                       <div class="text-center mt-12">
                           <button onclick="restart()" 
                                   class="glass text-white font-semibold py-3 px-8 rounded-2xl transition-all">
                               ← กลับไปแก้ไขโจทย์
                           </button>
                       </div>
                   </div>
               </div>
           `;
       }

       // Theory Selection
       function renderTheorySelection() {
           const relevantTheories = findRelevantTheories(currentState.topic);
           
           return `
               <div class="min-h-screen relative overflow-hidden fade-in">
                   <div class="container mx-auto px-4 py-8 relative z-10">
                       <div class="max-w-6xl mx-auto">
                           <div class="text-center mb-8">
                               <h1 class="text-3xl font-bold text-white mb-4 drop-shadow-lg">
                                   🧠 เลือกทฤษฎีที่เหมาะสมกับการวิจัย
                               </h1>
                               <div class="glass rounded-lg p-4 shadow-sm">
                                   <p class="text-white/90 mb-2">โจทย์วิจัย: <span class="font-medium text-white">${currentState.topic}</span></p>
                                   <p class="text-white/90">ระดับที่เลือก: <span class="font-medium text-white">ระดับ ${currentState.level}</span></p>
                               </div>
                           </div>

                           <div class="grid gap-6">
                               ${relevantTheories.map((theory) => `
                                   <div class="bg-white rounded-2xl border-2 border-gray-200 p-6 transition-all duration-200 hover:shadow-lg card-3d theory-card" 
                                        data-theory-id="${theory.id}">
                                       <div class="flex justify-between items-start mb-4">
                                           <div>
                                               <h3 class="text-xl font-bold text-gray-800 mb-2">${theory.name}</h3>
                                               <p class="text-gray-600">ผู้พัฒนา: ${theory.author}</p>
                                           </div>
                                           <div class="flex gap-2">
                                               <span class="px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800">
                                                   ระดับ ${theory.level === 1 ? 'พื้นฐาน' : theory.level === 2 ? 'กลาง' : 'สูง'}
                                               </span>
                                               <span class="px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">
                                                   คะแนน: ${theory.score}
                                               </span>
                                           </div>
                                       </div>

                                       <p class="text-gray-700 mb-4">${theory.description}</p>

                                       <div class="grid md:grid-cols-2 gap-4 mb-6">
                                           <div>
                                               <h4 class="font-semibold text-gray-800 mb-2">🎯 ปัจจัยหลัก:</h4>
                                               <ul class="text-sm text-gray-600 space-y-1">
                                                   ${theory.factors.map(factor => `
                                                       <li class="flex items-center">
                                                           <span class="w-2 h-2 bg-amber-400 rounded-full mr-2"></span>
                                                           ${factor}
                                                       </li>
                                                   `).join('')}
                                               </ul>
                                           </div>
                                           <div>
                                               <h4 class="font-semibold text-gray-800 mb-2">📊 วิธีการวิเคราะห์:</h4>
                                               <ul class="text-sm text-gray-600 space-y-1">
                                                   ${theory.statistics.map(stat => `
                                                       <li class="flex items-center">
                                                           <span class="w-2 h-2 bg-blue-400 rounded-full mr-2"></span>
                                                           ${stat}
                                                       </li>
                                                   `).join('')}
                                               </ul>
                                           </div>
                                       </div>

                                       <div class="bg-gray-50 rounded-lg p-4 mb-4">
                                           <h4 class="font-semibold text-gray-800 mb-2">🔗 ความสัมพันธ์ระหว่างตัวแปร:</h4>
                                           <p class="text-sm text-gray-700 font-mono bg-white p-2 rounded border">
                                               ${theory.relationships}
                                           </p>
                                       </div>

                                       <div class="bg-amber-50 rounded-lg p-4 mb-4">
                                           <h4 class="font-semibold text-amber-800 mb-2">💡 การคาดการณ์:</h4>
                                           <p class="text-sm text-amber-700">${theory.prediction}</p>
                                       </div>

                                       <button onclick="selectTheory('${theory.id}')" 
                                               class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold py-3 px-6 rounded-lg transition-all">
                                           ✅ เลือกทฤษฎีนี้
                                       </button>
                                   </div>
                               `).join('')}
                           </div>

                           <div class="text-center mt-8">
                               <button onclick="goToLevel()" 
                                       class="glass text-white font-semibold py-3 px-8 rounded-2xl transition-all">
                                   ← กลับไปเลือกระดับ
                               </button>
                           </div>
                       </div>
                   </div>
               </div>
           `;
       }

       // Results Page with Tab System
       function renderResults() {
           return `
               <div class="min-h-screen relative overflow-hidden fade-in">
                   <div class="container mx-auto px-4 py-8 relative z-10">
                       <div class="max-w-7xl mx-auto">
                           <!-- Header -->
                           <div class="glass rounded-lg p-6 shadow-sm mb-6">
                               <h1 class="text-3xl font-bold text-white mb-4">
                                   🎉 แผนการวิจัยของคุณ
                               </h1>
                               <div class="grid md:grid-cols-3 gap-4 text-sm">
                                   <div>
                                       <span class="text-white/90">โจทย์วิจัย:</span>
                                       <p class="font-medium text-white">${currentState.topic}</p>
                                   </div>
                                   <div>
                                       <span class="text-white/90">ระดับ:</span>
                                       <p class="font-medium text-white">ระดับ ${currentState.level}</p>
                                   </div>
                                   <div>
                                       <span class="text-white/90">ทฤษฎี:</span>
                                       <p class="font-medium text-white">${currentState.theory.name}</p>
                                   </div>
                               </div>
                               <div class="mt-4 flex gap-3">
                                   <button onclick="exportPDF()" 
                                           class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors flex items-center gap-2">
                                       📄 Export PDF
                                   </button>
                                   <button onclick="restart()" 
                                           class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors">
                                       🔄 เริ่มใหม่
                                   </button>
                               </div>
                           </div>

                           <!-- Tab Navigation -->
                           <div class="glass rounded-lg shadow-sm mb-6">
                               <div class="flex border-b border-white/20">
                                   <button onclick="switchTab('theory')" 
                                           class="flex-1 py-4 px-6 text-center font-medium transition-colors tab-active" 
                                           data-tab="theory">
                                       <div class="flex items-center justify-center gap-2">
                                           <span class="text-lg">📚</span>
                                           <span>ข้อมูลทฤษฎี</span>
                                       </div>
                                   </button>
                                   <button onclick="switchTab('research')" 
                                           class="flex-1 py-4 px-6 text-center font-medium transition-colors tab-inactive" 
                                           data-tab="research">
                                       <div class="flex items-center justify-center gap-2">
                                           <span class="text-lg">📋</span>
                                           <span>แผนการวิจัย</span>
                                       </div>
                                   </button>
                                   <button onclick="switchTab('statistics')" 
                                           class="flex-1 py-4 px-6 text-center font-medium transition-colors tab-inactive" 
                                           data-tab="statistics">
                                       <div class="flex items-center justify-center gap-2">
                                           <span class="text-lg">📊</span>
                                           <span>ขั้นตอนสถิติ</span>
                                       </div>
                                   </button>
                                   <button onclick="switchTab('spss')" 
                                           class="flex-1 py-4 px-6 text-center font-medium transition-colors tab-inactive" 
                                           data-tab="spss">
                                       <div class="flex items-center justify-center gap-2">
                                           <span class="text-lg">💻</span>
                                           <span>คู่มือ SPSS</span>
                                       </div>
                                   </button>
                               </div>
                           </div>

                           <!-- Tab Content -->
                           <div id="export-content" class="glass rounded-lg shadow-sm">
                               <div id="tab-content">
                                   ${renderTheoryTab()}
                               </div>
                           </div>
                       </div>
                   </div>
               </div>
           `;
       }

       // Theory Tab
       function renderTheoryTab() {
           const theory = currentState.theory;
           return `
               <div class="p-8">
                   <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                       📚 ข้อมูลทฤษฎี: ${theory.name}
                   </h2>
                   
                   <div class="grid lg:grid-cols-2 gap-8">
                       <div class="space-y-6">
                           <div class="bg-blue-500/20 rounded-lg p-6 border border-blue-500/30">
                               <h3 class="text-lg font-semibold text-blue-200 mb-3">ข้อมูลพื้นฐาน</h3>
                               <div class="space-y-3">
                                   <div>
                                       <span class="font-medium text-blue-100">ผู้พัฒนา:</span>
                                       <p class="text-blue-50">${theory.author}</p>
                                   </div>
                                   <div>
                                       <span class="font-medium text-blue-100">สาขา:</span>
                                       <p class="text-blue-50 capitalize">${theory.domain.replace('_', ' ')}</p>
                                   </div>
                                   <div>
                                       <span class="font-medium text-blue-100">ระดับ:</span>
                                       <p class="text-blue-50">ระดับ ${theory.level}</p>
                                   </div>
                               </div>
                           </div>

                           <div class="bg-green-500/20 rounded-lg p-6 border border-green-500/30">
                               <h3 class="text-lg font-semibold text-green-200 mb-3">คำอธิบาย</h3>
                               <p class="text-green-50">${theory.description}</p>
                           </div>

                           <div class="bg-purple-500/20 rounded-lg p-6 border border-purple-500/30">
                               <h3 class="text-lg font-semibold text-purple-200 mb-3">การคาดการณ์</h3>
                               <p class="text-purple-50">${theory.prediction}</p>
                           </div>
                       </div>

                       <div class="space-y-6">
                           <div class="bg-amber-500/20 rounded-lg p-6 border border-amber-500/30">
                               <h3 class="text-lg font-semibold text-amber-200 mb-4">ปัจจัยหลัก</h3>
                               <div class="space-y-3">
                                   ${theory.factors.map((factor, index) => `
                                       <div class="flex items-start gap-3">
                                           <span class="bg-amber-400 text-amber-900 px-2 py-1 rounded text-sm font-medium min-w-[24px] text-center">
                                               ${index + 1}
                                           </span>
                                           <span class="text-amber-50">${factor}</span>
                                       </div>
                                   `).join('')}
                               </div>
                           </div>

                           <div class="bg-gray-500/20 rounded-lg p-6 border border-gray-500/30">
                               <h3 class="text-lg font-semibold text-gray-200 mb-3">ความสัมพันธ์</h3>
                               <div class="bg-white/10 p-4 rounded border">
                                   <code class="text-gray-100 font-mono text-sm break-all">${theory.relationships}</code>
                               </div>
                               <p class="text-sm text-gray-300 mt-3">
                                   💡 <strong>สัญลักษณ์:</strong> → หมายถึง "ส่งผลต่อ", + หมายถึง "ร่วมกับ"
                               </p>
                           </div>

                           <div class="bg-rose-500/20 rounded-lg p-6 border border-rose-500/30">
                               <h3 class="text-lg font-semibold text-rose-200 mb-3">วิธีการวิเคราะห์</h3>
                               <div class="flex flex-wrap gap-2">
                                   ${theory.statistics.map(stat => `
                                       <span class="bg-rose-400/30 text-rose-100 px-3 py-1 rounded-full text-sm border border-rose-400/50">
                                           ${stat}
                                       </span>
                                   `).join('')}
                               </div>
                           </div>
                       </div>
                   </div>

                   <div class="mt-8 bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-6">
                       <h3 class="text-lg font-semibold text-yellow-200 mb-3">⚠️ ข้อควรระวัง</h3>
                       <ul class="text-yellow-100 space-y-2 text-sm">
                           <li>• ตรวจสอบความเหมาะสมของทฤษฎีกับบริบทการวิจัยของคุณ</li>
                           <li>• พิจารณาข้อจำกัดและสมมติฐานของทฤษฎี</li>
                           <li>• ศึกษางานวิจัยล่าสุดที่ใช้ทฤษฎีนี้เพื่อความทันสมัย</li>
                           <li>• ปรับปรุงตัวแปรให้เหมาะสมกับบริบทเฉพาะของคุณ</li>
                       </ul>
                   </div>
               </div>
           `;
       }

       // Research Plan Tab
       function renderResearchPlanTab() {
           const theory = currentState.theory;
           const level = currentState.level;
           
           return `
               <div class="p-8">
                   <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                       📋 แผนการวิจัยที่แนะนำ
                   </h2>
                   
                   <div class="grid lg:grid-cols-2 gap-8 mb-8">
                       <div class="bg-blue-500/20 rounded-lg p-6 border border-blue-500/30">
                           <h3 class="text-lg font-semibold text-blue-200 mb-4">🔬 ประเภทและวิธีการวิจัย</h3>
                           <div class="space-y-4">
                               <div>
                                   <h4 class="font-medium text-blue-100 mb-2">ประเภทการวิจัย:</h4>
                                   <p class="text-blue-50 text-sm">${level >= 2 ? 'การวิจัยเชิงปริมาณแบบสำรวจ (Quantitative Survey)' : 'การวิจัยเชิงพรรณนา (Descriptive Research)'}</p>
                               </div>
                               <div>
                                   <h4 class="font-medium text-blue-100 mb-2">ปรัชญาการวิจัย:</h4>
                                   <p class="text-blue-50 text-sm">ปรัชญาการวิจัยเชิงบวกนิยม (Positivism)</p>
                               </div>
                               <div>
                                   <h4 class="font-medium text-blue-100 mb-2">แนวทางการวิจัย:</h4>
                                   <p class="text-blue-50 text-sm">การวิจัยเชิงนิรนัย (Deductive Research)</p>
                               </div>
                               <div>
                                   <h4 class="font-medium text-blue-100 mb-2">กลยุทธ์การวิจัย:</h4>
                                   <p class="text-blue-50 text-sm">การสำรวจโดยใช้แบบสอบถาม (Survey Strategy)</p>
                               </div>
                           </div>
                       </div>

                       <div class="bg-green-500/20 rounded-lg p-6 border border-green-500/30">
                           <h3 class="text-lg font-semibold text-green-200 mb-4">👥 กลุ่มตัวอย่างและขอบเขต</h3>
                           <div class="space-y-4">
                               <div>
                                   <h4 class="font-medium text-green-100 mb-2">ขนาดกลุ่มตัวอย่าง:</h4>
                                   <p class="text-green-50 text-sm">${level === 1 ? '200-300 คน' : level === 2 ? '300-500 คน' : '500+ คน'}</p>
                               </div>
                               <div>
                                   <h4 class="font-medium text-green-100 mb-2">วิธีการสุ่มตัวอย่าง:</h4>
                                   <p class="text-green-50 text-sm">${level >= 2 ? 'การสุ่มตัวอย่างแบบหลายขั้นตอน (Multi-stage Sampling)' : 'การสุ่มตัวอย่างแบบง่าย (Simple Random Sampling)'}</p>
                               </div>
                               <div>
                                   <h4 class="font-medium text-green-100 mb-2">ช่วงเวลาการศึกษา:</h4>
                                   <p class="text-green-50 text-sm">${level >= 3 ? 'การศึกษาข้ามเวลา (Cross-sectional with Longitudinal elements)' : 'การศึกษาข้ามหน้าตัด (Cross-sectional Study)'}</p>
                               </div>
                           </div>
                       </div>
                   </div>

                   <!-- Timeline -->
                   <div class="bg-amber-500/20 rounded-lg p-6 border border-amber-500/30">
                       <h3 class="text-lg font-semibold text-amber-200 mb-4">⏰ แผนการดำเนินงานแนะนำ</h3>
                       <div class="space-y-4">
                           ${[
                               { phase: 'เตรียมการ', duration: '2-3 สัปดาห์', tasks: ['ศึกษาทฤษฎี', 'ออกแบบแบบสอบถาม', 'ทดสอบเครื่องมือ'] },
                               { phase: 'เก็บข้อมูล', duration: '4-6 สัปดาห์', tasks: ['แจกแบบสอบถาม', 'ติดตามการตอบกลับ', 'ตรวจสอบความสมบูรณ์'] },
                               { phase: 'วิเคราะห์ข้อมูล', duration: level >= 3 ? '6-8 สัปดาห์' : '3-4 สัปดาห์', tasks: ['ทำความสะอาดข้อมูล', 'วิเคราะห์ทางสถิติ', 'ตีความผลลัพธ์'] },
                               { phase: 'เขียนรายงาน', duration: '3-4 สัปดาห์', tasks: ['เขียนร่าง', 'ปรับปรุงเนื้อหา', 'จัดทำรูปแบบสุดท้าย'] }
                           ].map((item, index) => `
                               <div class="flex gap-4 items-start">
                                   <div class="bg-amber-400 text-amber-900 px-3 py-1 rounded-full text-sm font-medium min-w-[100px] text-center">
                                       ${item.duration}
                                   </div>
                                   <div class="flex-1">
                                       <h4 class="font-medium text-amber-100 mb-1">${item.phase}</h4>
                                       <p class="text-amber-50 text-sm">${item.tasks.join(' • ')}</p>
                                   </div>
                               </div>
                           `).join('')}
                       </div>
                   </div>
               </div>
           `;
       }

       // Statistics Tab
       function renderStatisticsTab() {
           const level = currentState.level;
           const steps = researchDatabase.levels[level].statisticalSteps;
           
           return `
               <div class="p-8">
                   <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                       📊 ขั้นตอนการวิเคราะห์ทางสถิติ (ระดับ ${level})
                   </h2>
                   
                   <!-- Progress Timeline -->
                   <div class="mb-8 bg-white/5 rounded-lg p-6 border border-white/10">
                       <h3 class="text-lg font-semibold text-white mb-4">🗺️ แผนที่ขั้นตอนการวิเคราะห์</h3>
                       <div class="flex flex-wrap gap-2 mb-4">
                           ${steps.map((step, index) => `
                               <div class="flex items-center">
                                   <div class="bg-blue-600 text-white px-3 py-2 rounded-lg text-sm font-medium text-center min-w-[120px]">
                                       ${step.step}. ${step.name}
                                   </div>
                                   ${index < steps.length - 1 ? '<div class="text-white/40 mx-2">→</div>' : ''}
                               </div>
                           `).join('')}
                       </div>
                   </div>

                   <!-- Detailed Steps -->
                   <div class="space-y-6">
                       ${steps.map((step) => `
                           <div class="bg-white/5 rounded-lg p-6 border border-white/10">
                               <div class="flex items-start gap-4 mb-4">
                                   <div class="w-10 h-10 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-lg">
                                       ${step.step}
                                   </div>
                                   <div class="flex-1">
                                       <h3 class="text-xl font-bold text-white mb-2">${step.name}</h3>
                                       <p class="text-white/80">${step.description}</p>
                                       <div class="mt-2 inline-block bg-blue-500/20 text-blue-200 px-3 py-1 rounded-full text-sm border border-blue-500/30">
                                           ⏱️ ระยะเวลา: ${step.duration}
                                       </div>
                                   </div>
                               </div>

                               <div class="grid md:grid-cols-2 gap-6">
                                   <div>
                                       <h4 class="font-semibold text-white mb-3">📝 รายการที่ต้องทำ</h4>
                                       <ul class="space-y-2">
                                           ${step.details.map(detail => `
                                               <li class="flex items-start gap-2">
                                                   <span class="flex-shrink-0 w-2 h-2 bg-green-400 rounded-full mt-2"></span>
                                                   <span class="text-sm text-white/90">${detail}</span>
                                               </li>
                                           `).join('')}
                                       </ul>
                                   </div>

                                   <div>
                                       <h4 class="font-semibold text-white mb-3">🛠️ เครื่องมือที่ใช้</h4>
                                       <ul class="space-y-2">
                                           ${step.tools.map(tool => `
                                               <li class="flex items-center gap-2">
                                                   <span class="flex-shrink-0 w-2 h-2 bg-blue-400 rounded-full"></span>
                                                   <span class="text-sm text-white/90 bg-white/10 px-2 py-1 rounded border border-white/20">
                                                       ${tool}
                                                   </span>
                                               </li>
                                           `).join('')}
                                       </ul>
                                   </div>
                               </div>
                           </div>
                       `).join('')}
                   </div>

                   <!-- เกณฑ์มาตรฐาน -->
                   <div class="mt-8 bg-gray-500/10 rounded-lg p-6 border border-gray-500/20">
                       <h3 class="text-lg font-semibold text-gray-200 mb-4">📊 เกณฑ์มาตรฐานการตีความสถิติ</h3>
                       <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                           <div class="bg-white/5 p-4 rounded-lg border border-white/10">
                               <h4 class="font-medium text-green-300 mb-2">ความเชื่อมั่น (Reliability)</h4>
                               <ul class="text-sm text-white/80 space-y-1">
                                   <li>• Cronbach's Alpha ≥ 0.70</li>
                                   <li>• Composite Reliability ≥ 0.70</li>
                                   <li>• Item-Total Correlation ≥ 0.30</li>
                               </ul>
                           </div>
                           <div class="bg-white/5 p-4 rounded-lg border border-white/10">
                               <h4 class="font-medium text-blue-300 mb-2">ความตรง (Validity)</h4>
                               <ul class="text-sm text-white/80 space-y-1">
                                   <li>• Factor Loading ≥ 0.50 (EFA)</li>
                                   <li>• Factor Loading ≥ 0.70 (CFA)</li>
                                   <li>• AVE ≥ 0.50</li>
                               </ul>
                           </div>
                           <div class="bg-white/5 p-4 rounded-lg border border-white/10">
                               <h4 class="font-medium text-purple-300 mb-2">ความกลมกลืนของโมเดล</h4>
                               <ul class="text-sm text-white/80 space-y-1">
                                   <li>• CFI, TLI ≥ 0.95</li>
                                   <li>• RMSEA ≤ 0.08</li>
                                   <li>• χ²/df < 3</li>
                               </ul>
                           </div>
                       </div>
                   </div>
               </div>
           `;
       }

       // SPSS Guide Tab
       function renderSPSSTab() {
           const level = currentState.level;
           const availableGuides = ['descriptive', 'reliability', 'efa', 'regression'];
           if (level >= 3) {
               availableGuides.push('cfa', 'sem');
           }
           
           return `
               <div class="p-8">
                   <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                       💻 คู่มือการใช้งาน SPSS (ระดับ ${level})
                   </h2>
                   
                   <!-- Guide Navigation -->
                   <div class="mb-8 bg-white/5 rounded-lg overflow-hidden border border-white/10">
                       <div class="flex flex-wrap border-b border-white/20">
                           ${availableGuides.map((guideKey, index) => {
                               const guide = researchDatabase.spssGuides[guideKey];
                               return `
                                   <button onclick="switchSPSSGuide('${guideKey}')" 
                                           class="flex-1 min-w-[150px] py-4 px-6 text-center font-medium transition-colors spss-guide-btn ${index === 0 ? 'bg-amber-500 text-white' : 'bg-white/5 text-white/70 hover:bg-white/10 hover:text-white'}" 
                                           data-guide="${guideKey}">
                                       <div class="flex items-center justify-center gap-2">
                                           <span class="text-lg">${guide.icon}</span>
                                           <span class="text-sm">${guide.title}</span>
                                       </div>
                                   </button>
                               `;
                           }).join('')}
                       </div>
                   </div>

                   <!-- Guide Content -->
                   <div id="spss-guide-content">
                       ${renderSPSSGuideContent('descriptive')}
                   </div>
               </div>
           `;
       }

       // SPSS Guide Content
       function renderSPSSGuideContent(guideKey) {
           const guide = researchDatabase.spssGuides[guideKey];
           
           return `
               <div class="bg-white/5 rounded-lg border border-white/10 p-6">
                   <h3 class="text-xl font-bold text-white mb-6 flex items-center gap-3">
                       ${guide.icon} ${guide.title}
                   </h3>

                   <!-- Steps -->
                   <div class="mb-8">
                       <h4 class="text-lg font-semibold text-white mb-4">📋 ขั้นตอนการดำเนินงาน</h4>
                       <div class="space-y-6">
                           ${guide.steps.map((step, index) => `
                               <div class="flex gap-4 p-4 bg-white/5 rounded-lg border border-white/10">
                                   <div class="flex-shrink-0">
                                       <div class="w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-sm">
                                           ${index + 1}
                                       </div>
                                   </div>
                                   <div class="flex-1">
                                       <h5 class="font-semibold text-white mb-2">${step.step}</h5>
                                       <p class="text-white/80 mb-3">${step.instruction}</p>
                                       <div class="bg-white/10 p-2 rounded border border-blue-500/30">
                                           <span class="text-blue-300 font-mono text-sm">
                                               📍 เมนู: ${step.menu}
                                           </span>
                                       </div>
                                   </div>
                               </div>
                           `).join('')}
                       </div>
                   </div>

                   <!-- Interpretation -->
                   <div class="bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-6 mb-6">
                       <h4 class="text-lg font-semibold text-yellow-200 mb-4">
                           📏 เกณฑ์การตีความ
                       </h4>
                       <div class="grid md:grid-cols-2 gap-3">
                           ${guide.interpretation.map(criterion => `
                               <div class="bg-white/10 p-3 rounded border border-white/20">
                                   <span class="text-sm text-yellow-100">${criterion}</span>
                               </div>
                           `).join('')}
                       </div>
                   </div>

                   <!-- Template -->
                   <div class="bg-green-500/20 border border-green-500/30 rounded-lg p-6">
                       <h4 class="text-lg font-semibold text-green-200 mb-4">📝 Template การเขียนรายงาน</h4>
                       <div class="bg-white/10 p-4 rounded border border-white/20 font-mono text-sm">
                           <p class="text-green-100">${guide.template}</p>
                       </div>
                   </div>
               </div>
           `;

           }

       // Functions
       function setExample(text) {
           document.getElementById('researchTopic').value = text;
       }

       function analyzeTopic() {
           const topic = document.getElementById('researchTopic').value;
           if (topic.trim()) {
               currentState.topic = topic;
               currentState.page = 'level';
               render();
           } else {
               alert('กรุณาใส่โจทย์วิจัย 📝');
           }
       }

       function selectLevel(level) {
           currentState.level = level;
           currentState.page = 'theory';
           render();
       }

       function goToLevel() {
           currentState.page = 'level';
           render();
       }

       function selectTheory(theoryId) {
           currentState.theory = researchDatabase.theories[theoryId];
           currentState.page = 'results';
           render();
       }

       function switchTab(tabName) {
           currentState.activeTab = tabName;
           
           // Update tab appearance
           document.querySelectorAll('[data-tab]').forEach(btn => {
               btn.classList.remove('tab-active');
               btn.classList.add('tab-inactive');
           });
           
           document.querySelector(`[data-tab="${tabName}"]`).classList.remove('tab-inactive');
           document.querySelector(`[data-tab="${tabName}"]`).classList.add('tab-active');

           // Update content
           let content = '';
           switch(tabName) {
               case 'theory':
                   content = renderTheoryTab();
                   break;
               case 'research':
                   content = renderResearchPlanTab();
                   break;
               case 'statistics':
                   content = renderStatisticsTab();
                   break;
               case 'spss':
                   content = renderSPSSTab();
                   break;
           }
           
           document.getElementById('tab-content').innerHTML = content;
       }

       function switchSPSSGuide(guideKey) {
           currentState.activeSPSSGuide = guideKey;
           
           // Update guide nav buttons
           document.querySelectorAll('.spss-guide-btn').forEach(btn => {
               btn.classList.remove('bg-amber-500', 'text-white');
               btn.classList.add('bg-white/5', 'text-white/70', 'hover:bg-white/10', 'hover:text-white');
           });
           
           document.querySelector(`[data-guide="${guideKey}"]`).classList.remove('bg-white/5', 'text-white/70', 'hover:bg-white/10', 'hover:text-white');
           document.querySelector(`[data-guide="${guideKey}"]`).classList.add('bg-amber-500', 'text-white');

           // Update content
           document.getElementById('spss-guide-content').innerHTML = renderSPSSGuideContent(guideKey);
       }

       function exportPDF() {
           try {
               const element = document.getElementById('export-content');
               if (!element) {
                   alert('ไม่พบเนื้อหาที่จะ Export');
                   return;
               }

               // Show loading overlay
               const loadingOverlay = document.createElement('div');
               loadingOverlay.innerHTML = `
                   <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; z-index: 9999;">
                       <div style="color: white; text-align: center;">
                           <div style="font-size: 3rem; margin-bottom: 1rem;">📄</div>
                           <div style="font-size: 1.5rem; font-weight: bold;">กำลังสร้าง PDF...</div>
                           <div style="margin-top: 0.5rem;">กรุณารอสักครู่</div>
                       </div>
                   </div>
               `;
               document.body.appendChild(loadingOverlay);

               setTimeout(async () => {
                   try {
                       const canvas = await html2canvas(element, {
                           scale: 1.5,
                           useCORS: true,
                           allowTaint: true,
                           backgroundColor: '#ffffff',
                           width: element.scrollWidth,
                           height: element.scrollHeight
                       });

                       const imgData = canvas.toDataURL('image/png');
                       const { jsPDF } = window.jspdf;
                       const pdf = new jsPDF('p', 'mm', 'a4');
                       
                       const imgWidth = 210;
                       const pageHeight = 295;
                       const imgHeight = (canvas.height * imgWidth) / canvas.width;
                       let heightLeft = imgHeight;
                       let position = 0;

                       pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                       heightLeft -= pageHeight;

                       while (heightLeft >= 0) {
                           position = heightLeft - imgHeight;
                           pdf.addPage();
                           pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                           heightLeft -= pageHeight;
                       }

                       const fileName = `Research_Plan_${currentState.theory.name.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.pdf`;
                       pdf.save(fileName);

                       document.body.removeChild(loadingOverlay);
                       
                       // Show success message
                       const successOverlay = document.createElement('div');
                       successOverlay.innerHTML = `
                           <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(34, 197, 94, 0.95); color: white; padding: 2rem; border-radius: 1rem; text-align: center; z-index: 9999;">
                               <div style="font-size: 3rem; margin-bottom: 1rem;">✅</div>
                               <div style="font-size: 1.2rem; font-weight: bold;">PDF ถูกสร้างเรียบร้อยแล้ว!</div>
                               <div style="margin-top: 0.5rem;">ไฟล์ได้รับการดาวน์โหลดแล้ว</div>
                           </div>
                       `;
                       document.body.appendChild(successOverlay);
                       
                       setTimeout(() => {
                           document.body.removeChild(successOverlay);
                       }, 3000);

                   } catch (error) {
                       document.body.removeChild(loadingOverlay);
                       console.error('Error generating PDF:', error);
                       alert('เกิดข้อผิดพลาดในการสร้าง PDF กรุณาลองใหม่อีกครั้ง');
                   }
               }, 500);

           } catch (error) {
               console.error('Error in exportPDF:', error);
               alert('เกิดข้อผิดพลาดในการสร้าง PDF กรุณาลองใหม่อีกครั้ง');
           }
       }

       function restart() {
           currentState = {
               page: 'landing',
               topic: '',
               level: null,
               theory: null,
               activeTab: 'theory',
               activeSPSSGuide: 'descriptive'
           };
           render();
       }

       function render() {
           const app = document.getElementById('app');
           
           switch(currentState.page) {
               case 'landing':
                   app.innerHTML = renderLanding();
                   break;
               case 'level':
                   app.innerHTML = renderLevelSelection();
                   break;
               case 'theory':
                   app.innerHTML = renderTheorySelection();
                   break;
               case 'results':
                   app.innerHTML = renderResults();
                   break;
               default:
                   app.innerHTML = renderLanding();
           }
       }

       // Initialize app
       document.addEventListener('DOMContentLoaded', function() {
           render();
       });

       // Also render immediately
       render();
   </script>
</body>
</html>
                                               
                    
